(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[542],{1165:function(t,e,n){Promise.resolve().then(n.bind(n,9605))},8792:function(t,e,n){"use strict";n.d(e,{default:function(){return a.a}});var r=n(5250),a=n.n(r)},9605:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return d}});var r=n(3827),a=n(4090),i=n(716),o=n(4344),s=n(2829),c=n(2966),l=n(8792);function d(){let{contractService:t,error:e}=(0,i.useContractContext)(),[n,d]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[y,x]=(0,a.useState)(null),[w,g]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{b(!0)},[]);let T=async()=>{if(!u){x("Please connect your wallet first");return}if(!t){x("Contract service not initialized");return}if(!n||0>=Number(n)){x("Please enter a valid amount");return}m(!0),x(null),g(null);try{let e=new o.ZPm(window.ethereum),r=e.utils.toWei(n,"ether");console.log("Creating TUSDT contract instance...");let a=new e.eth.Contract([{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],type:"function"}],s.xk.TESTNET.TUSDT);console.log("Approving TUSDT spend...");let i=await a.methods.approve(s.xk.TESTNET.LOGIC,r).send({from:u});console.log("TUSDT approved:",i),g("TUSDT spending approved"),console.log("Buying TSC...");let c=await t.buyTSC(r);console.log("Buy transaction:",c),g("Successfully purchased TSC!"),d("")}catch(t){console.error("Purchase failed:",t),x(t instanceof Error?t.message:"Purchase failed")}finally{m(!1)}};return f?(0,r.jsx)("main",{className:"min-h-screen bg-black text-white py-32",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-8",children:[(0,r.jsx)("div",{className:"mb-12",children:(0,r.jsxs)(l.default,{href:"/",className:"text-brand-cyan hover:text-brand-cyan/80 transition-colors flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Home"]})}),(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-brand-cyan to-brand-pink rounded-xl blur opacity-75"}),(0,r.jsx)("div",{className:"relative bg-black/90 backdrop-blur-sm border border-white/10 rounded-xl p-12",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white",children:"Buy TikStar Coin"}),(0,r.jsxs)("p",{className:"text-xl text-gray-400",children:["Current Price: ",(0,r.jsx)("span",{className:"text-brand-cyan",children:"0.05 USDT"})," per TSC"]})]}),(0,r.jsx)("div",{className:"space-y-8",children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-black/50 border border-white/10 rounded-lg p-4",children:[(0,r.jsx)("span",{className:"block text-sm text-gray-400",children:"Connected Wallet"}),(0,r.jsxs)("span",{className:"block text-white font-mono",children:[u.slice(0,6),"...",u.slice(-4)]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-lg font-medium text-gray-300 mb-3",children:"Amount (USDT)"}),(0,r.jsx)("input",{type:"number",value:n,onChange:t=>d(t.target.value),className:"w-full bg-black/50 border border-white/10 rounded-lg px-6 py-4 text-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brand-cyan/50",placeholder:"Enter amount"}),(0,r.jsxs)("div",{className:"mt-2 flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-400",children:["You will receive: ",n?Number(n)/.05:0," TSC"]}),(0,r.jsx)("button",{onClick:()=>d("100"),className:"text-brand-cyan hover:text-brand-cyan/80 transition-colors",children:"Buy with 100 USDT"})]})]}),(0,r.jsxs)("button",{onClick:T,disabled:h||!n||0>=Number(n),className:"relative w-full group disabled:opacity-50",children:[(0,r.jsx)("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-brand-cyan to-brand-pink rounded-lg blur opacity-60 group-hover:opacity-100 transition"}),(0,r.jsx)("div",{className:"relative w-full px-8 py-4 bg-black rounded-lg leading-none flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xl font-medium text-white",children:h?"Processing...":"Buy TSC"})})]}),y&&(0,r.jsx)("div",{className:"p-4 rounded-lg border border-red-500/50 bg-red-500/10",children:(0,r.jsx)("span",{className:"text-sm text-red-400",children:y})}),w&&(0,r.jsx)("div",{className:"p-4 rounded-lg border border-green-500/50 bg-green-500/10",children:(0,r.jsx)("span",{className:"text-sm text-green-400",children:w})}),e&&(0,r.jsx)("div",{className:"p-4 rounded-lg border border-red-500/50 bg-red-500/10",children:(0,r.jsx)("span",{className:"text-sm text-red-400",children:e})})]})]}):(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(c.Z,{onConnect:t=>{p(t),x(null)}})})})]})})]})]})}):null}},716:function(t,e,n){"use strict";n.r(e),n.d(e,{ContractProvider:function(){return d},useContractContext:function(){return u}});var r=n(3827),a=n(4090),i=n(4344),o=n(2829);class s{initializeContract(t){try{this.contract=new this.web3.eth.Contract(t,o.xk.TESTNET.LOGIC)}catch(t){console.error("Failed to initialize contract:",t)}}async joinExpert(t,e){try{if(!this.contract)throw Error("Contract not initialized");let n=await this.web3.eth.getAccounts();return await this.contract.methods[o.ti.JOIN_EXPERT](t,e).send({from:n[0]}),!0}catch(t){return console.error("Failed to join as expert:",t),!1}}async getExpertSize(){try{if(!this.contract)throw Error("Contract not initialized");let t=await this.contract.methods[o.ti.GET_EXPERT_SIZE]().call();return Number(t)}catch(t){return console.error("Failed to get expert size:",t),0}}async getExpertInfo(){try{if(!this.contract)throw Error("Contract not initialized");return await this.contract.methods[o.ti.GET_EXPERT_INFO]().call()}catch(t){return console.error("Failed to get expert info:",t),[]}}async acceptInvitation(t){try{if(!this.contract)throw Error("Contract not initialized");let e=await this.web3.eth.getAccounts();return await this.contract.methods[o.ti.ACCEPT_INVITATION](t).send({from:e[0]}),!0}catch(t){return console.error("Failed to accept invitation:",t),!1}}async getInvitationSize(t){try{if(!this.contract)throw Error("Contract not initialized");let e=await this.contract.methods[o.ti.GET_INVITATION_SIZE](t).call();return Number(e)}catch(t){return console.error("Failed to get invitation size:",t),0}}async getInvitationInfo(t){try{if(!this.contract)throw Error("Contract not initialized");return await this.contract.methods[o.ti.GET_INVITATION_INFO](t).call()}catch(t){return console.error("Failed to get invitation info:",t),[]}}async getBrandSize(){try{if(!this.contract)throw Error("Contract not initialized");let t=await this.contract.methods[o.ti.GET_BRAND_SIZE]().call();return Number(t)}catch(t){return console.error("Failed to get brand size:",t),0}}async getBrandInfo(){try{if(!this.contract)throw Error("Contract not initialized");return await this.contract.methods[o.ti.GET_BRAND_INFO]().call()}catch(t){return console.error("Failed to get brand info:",t),[]}}async buyTSC(t){try{if(!this.contract)throw Error("Contract not initialized");let e=await this.web3.eth.getAccounts();return await this.contract.methods[o.ti.BUY_TSC](t).send({from:e[0]}),!0}catch(t){return console.error("Failed to buy TSC:",t),!1}}constructor(t,e){this.web3=new i.ZPm(t),this.contract=null,this.initializeContract(e)}}var c=JSON.parse('[{"inputs":[{"internalType":"string","name":"tikTokId","type":"string"},{"internalType":"string","name":"email","type":"string"}],"name":"joinExpert","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"upAddress","type":"address"}],"name":"acceptInvitation","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"buy","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getExpertSize","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getExpertInfo","outputs":[{"components":[{"internalType":"string","name":"tikTokId","type":"string"},{"internalType":"string","name":"email","type":"string"},{"internalType":"address","name":"_add","type":"address"}],"internalType":"struct TikStarCoin.Expert[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"address","type":"address"}],"name":"getInvitationSize","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"address","type":"address"}],"name":"getInvitationInfo","outputs":[{"components":[{"internalType":"address","name":"_add","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct TikStarCoin.UserBuy[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getBrandSize","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getBrandInfo","outputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"remarks","type":"string"},{"internalType":"string","name":"logo","type":"string"}],"internalType":"struct TikStarCoin.Brand[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"}]');let l=(0,a.createContext)({contractService:null,error:null});function d(t){let{children:e}=t,[n,d]=(0,a.useState)(null),[u,p]=(0,a.useState)(null);return(0,a.useEffect)(()=>((async()=>{try{if(void 0===window.ethereum)throw Error("Please install MetaMask to use this application");let t=await window.ethereum.request({method:"eth_requestAccounts"});if(!t||0===t.length)throw Error("Please connect your MetaMask wallet");let e=await window.ethereum.request({method:"eth_chainId"});if(97!==parseInt(e,16))throw Error("Please switch to BSC Testnet (Chain ID: 97)");let n=new i.ZPm(window.ethereum),r=new s(window.ethereum,c),a=await n.eth.getCode(o.xk.TESTNET.LOGIC);if("0x"===a||"0x0"===a)throw Error("Contract not deployed at specified address");d(r),p(null)}catch(t){p(t instanceof Error?t.message:"Failed to initialize contract service"),console.error("Contract initialization error:",t)}})(),window.ethereum&&(window.ethereum.on("chainChanged",()=>{window.location.reload()}),window.ethereum.on("accountsChanged",()=>{window.location.reload()})),()=>{window.ethereum&&(window.ethereum.removeListener("chainChanged",()=>{}),window.ethereum.removeListener("accountsChanged",()=>{}))}),[]),(0,r.jsx)(l.Provider,{value:{contractService:n,error:u},children:e})}function u(){let t=(0,a.useContext)(l);if(void 0===t)throw Error("useContractContext must be used within a ContractProvider");return t}}},function(t){t.O(0,[250,714,162,971,69,744],function(){return t(t.s=1165)}),_N_E=t.O()}]);